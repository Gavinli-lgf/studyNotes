# [谈谈无人车横向控制](https://mp.weixin.qq.com/s/pqs8UccxqfzaEnLauI7WBQ)
## 1. 概述
1. 车辆横向控制的设计有三种方法：
  1. 第一种是完全基于控制层的上一级动作规划（Motion Planning）控制，没有考虑到道路几何特性，通常用PID做反馈控制。
  2. 第二种是基于模仿驾驶员行为；
  3. 最后一种是基于车辆动力学模型和控制理论。
2. 上述方法的使用特点：
  1. 上述1和2不需要车辆动力学的精确知识，仅需要一个表达响应特性的车辆模型和一个模拟驾驶员行为的控制器。
  2. 上述2和3可融合使用。
  3. 上述3需要一个较好的车辆动力学模型，然后用不同的控制算法来达到特定目标。
3. 现状：行驶的汽车是一个复杂的强耦合、变参数的非线性系统，其纵向、横向运动是相互耦合、相互影响的，特别是车辆在不平路面上高速行驶时，其耦合特性更加明显。目前初创企业的车辆纵向、横向控制往往是通过两个独立的控制器完成的，高速、弯道、坡道下表现较差。
## 2. 上述3种控制器典型算法简介
1. 无模型控制器**PID控制器**：
  1. 用法：常使用两个基于PID反馈控制的控制器来分别控制方向盘转角δ以及前进速度Vs。或者采用多级pid进行控制。
  2. 优缺点：PID法缺点很明显，难以有效地应用于多变量系统和时变系统，基本上没有考虑道路特性，只能应用于低速，小半径弯道，且容易出现振荡，特别是在弯道后期，方向盘容易出现抖动。高速或大半径弯道则会出现偏离度很大，急拐。舒适性极差。

2. 驾驶员行为模型控制器**预瞄跟随理论**：
  1. 算法思想：郭孔辉院士在1982年提出，预瞄跟随理论是一种人车路的闭环理论，人类驾驶员在开车时，会在前方道路上选定一个要达到的点，这个点称之为预瞄点，车与预瞄点之间的距离为预瞄距离。驾驶员通过对车辆的操控到达预瞄点，再选定新的预瞄点，这就是人类驾驶员的驾驶行为。
  2. 数学模型推导：首先，建立驾驶员相对坐标系。将道路在绝对坐标下的轨迹函数转换成反映于驾驶员相对坐标系下的道路函数，由连续两个预瞄点A和B的坐标位置计算出最佳转弯曲率[公式1](./appendix/1.png)，再由下式计算出方向盘转角量[公式2](./appendix/1.png)。
  3. 预瞄跟随法考虑到了道路的几何特性，这种几何特性的输入一般称之为前馈，它当然可以用PID来控制误差，一般是控制横向误差。预瞄控制法依赖预瞄点的选择，大部分时候预瞄距离是个固定的经验值，也有少数自适应预瞄距离的研究，这就限制了其灵活性，小半径和低速下表现良好，高速和大弯道下还需要进一步研究增强。
3. 基于车辆模型与控制理论**通用汽车在无人车横向控制领域的一项专利**
  1. 专利内容概述：依据高正确度（或者高精确度）地图提供的道路曲率、倾斜度和坡度，得出一个体感舒适的转向控制角度和转向控制角速度。当然，车道线级定位还是难点。
  2. 车辆模型：车辆模型是单轨经典自行车模型，当然要不嫌麻烦的话还有4自由度、6自由度甚至17自由度模型。状态向量X根据厂家的专业能力而不同，对无法深入车辆底层的厂家来说，X就是EPS角度接口，对传统车厂则下沉一层到EPS的扭矩接口。对于后轮是否可以转向，车辆模型还会有变化。
  3. 得到数学模型化后，下一步就是用最小二次代价函数法求得函数J的控制变量U，以此最小化期望路径与实际路径之间的误差。














