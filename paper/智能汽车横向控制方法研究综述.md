# 智能汽车横向控制方法研究综述
陈慧岩, 陈舒平, 龚建伟
## 摘要：
* 综述了智能汽车横向控制的国内外发展历程与研究现状
* 介绍了车辆横向动力学和轮胎力学的研究历程和模型;
* 智能汽车横向控制研究的重点和发展趋势
## 0 引言
* 纵向控制：是指调整车速使车辆间保持足够的空间,使用最少的制动保持相对恒定的车速,并在紧急情况下尽可能快的制动。
* 横向控制：是指路径跟踪,即通过自动转向控制使车辆始终沿着期望路径行驶,同时保证车辆的行驶安全性和乘坐舒适性。（**所以，说“路径跟踪”时，基本是指“横向控制”。**）
* 汽车是一个强耦合变参数的非线性系统,汽车的纵向运动和横向运动存在很强的耦合关系,耦合效应包含3类:运动学耦合、轮胎力耦合、载荷转移耦合。（对于这些耦合关系，也有相应的论文研究）
## 1 智能汽车横向控制的发展历程
* 根据环境感知传感系统的不同,智能汽车横向控制可分为非前瞻式参考系统和前瞻式参考系统。
  1. 非前瞻式参考系统：通过计算车辆附近的期望道路与车辆之间的横向位置偏差来控制车辆实现道路跟踪。（相当于没有预瞄）
  2. 前瞻式参考系统：通过测量车辆前方的期望道路与车辆之间的横向位置偏差来控制车辆实现自动转向。（预瞄，车辆与预瞄点之间，而非《基于预瞄的智能车辆路径跟踪控制研究_倪兰青》的预瞄方式）
* 主要发展节点：
  1. Fenton等先后2次设计控制算法，先用经典控制理论，再用最优控制技术和观测器设计；但两次都是用反馈控制器,依赖反馈控制的抗干扰能力来跟踪道路曲率。（只反馈无前馈）
  2. Ackermann使用鲁棒反馈控制既可以满足直线跟踪也可以满足车速,载荷和路面条件等参数变化的曲线跟踪。（在反馈的基础上，更详细的处理了车辆质量分布的假设）
  3. Peng 等提出自动转向前馈-反馈控制算法,前馈控制量是由道路曲率计算的稳态前轮偏角或预瞄前轮转角,反馈控制算法采用频率线性二次型(FSLQ) 最优控制理论来设计计,考虑跟踪误差的同时也保证了车辆乘坐舒适性。（同时考虑了前馈与反馈，FSLQ是不是就是LQR？）
  4. Hessburg 等基于非前瞻式参考系统,研究了使用前馈鄄PID 反馈控制算法和离散磁道钉参考系统进行实车横向控制的可行性。
  5. Peng等基于上述方法实车测试时，高速的误差变大，提出了自动转向预瞄控制算法，采用预瞄距离内的道路曲率信息来计算前馈控制量。
  6. 在文献[23] 中,2002 年,Kato 等基于差分全局定位系统的航迹推算功能设计了横向控制算法,车辆由包含一系列路点的精确地图引导。（**现在高精地图方案的原型**）
  7. 2003 年,Hernandez 等使用 GPS 从数字地图中提取地理信息来修正非前瞻式参考系统的控制器,提高了道路跟踪的精度。
  8. 2005 年,美国斯坦福大学参赛的智能车 Stanley 基于车辆-道路几何关系设计了自动转向控制器,该控制器由前轴处的方向偏差和横向位置偏差两部分组成,并通过比例增益来调节不同车速下的控制律。（**没有预瞄，通过几何关系、不同车速下的比例增益，来控制前轴中心点的横向偏差、朝向偏差。**）
  9. 2007 年, 美国卡内基梅隆大学参赛的智能车 Boss 采用综合了任务规划、行为规划和运动规划的 3 层规划系统,在城市环境下行驶车速达到48km/h。（**现在车辆自动驾驶中，划分为routing、planning、control等层级的原型**）
  10. 2008 年,Besselmann 等提出混合变参数的模型预测控制,应用于自主车辆转向控制。（**使用非线性模型进行控制**）
  11. 2009 年,Kritayakirana 等开发了基于 Audi TTS 原型车的智能车辆平台,以实现车辆极限工况下的自主驾驶。 该平台的自动转向控制采用前馈-反馈控制,前馈量由期望道路曲率直接计
算得出,而反馈量由两部分组成,一个是由偏离车道的位置偏差计算,另一个是以保证车辆横摆运动收敛来计算。
  12. 2014 年,Hindiyeh 等提出一种使后轮驱动车辆在后轮摩擦力饱和时,能自主地稳态转向的控制方法。（目前不考虑这种工况）
  13. 2015 年,Hong 等提出了一种使车辆转弯时侧倾运动最小化的模型预测控制方法。（目前不考虑这种工况）
  14. 2016 年,Wang 等采用主动前轮转向和直接横摆力矩共同控制的方法研究了四轮独立驱动自主车辆的路径跟踪控制问题,提出了一种改进的合成非线性反馈控制策略来提高瞬态性能,消除路径跟踪控制的稳态误差。
* 包含“模糊逻辑控制”的自主车辆控制
  1. 模糊逻辑控制为车辆自动转向控制提供了一个考虑驾驶员经验和工程判断的平台。（**应该是类似于强化学习、人工智能等方法的使用**）
  2.  1991 年到 1994 年间,Hessburg 等基于非前瞻式参考系统,使用模糊逻辑控制器研究了车辆横向控制,在全尺寸车辆上实施了人工调节的模糊控制器, 其包含3部分模型:反馈、预瞄和增益调节。
* 国内的研究现状：
  1. 文献[34] 提出将变论域模糊控制、自适应技术和 H肄 最优控制理论相结合实现对自主汽车的侧向系统进行控制,提高了系统的鲁棒性和控制精度。
  2. 文献[35]指出预瞄在高速自主车的轨迹跟踪中起着举足轻重的作用,将预瞄与反馈线性化方法相结合是下一步系统设计的一个方向。(**现在Apollo控制方案中，那些要用预瞄，哪些不用预瞄，可以看下这篇文章。**)
  3. 文献[36] 基于单点预瞄最优曲率模型设计侧向加速度 PD 跟踪控制器,联合车- 路横向动力学模型构建横向控制闭环系统,设计模糊控制器对预瞄距离进行模糊选择,以提高车辆横向控制精度和减小侧向加速度,采用遗传算法对模糊规则进行优化以使横向控制系统性能达到最优。(太复杂，实际工程中使用不来)
## 2 智能汽车整车动力学建模和控制
* 智能车辆横向控制的设计有两种方法:一种是基于模仿驾驶员行为,另一种是基于车辆动力学模型和控制理论。本文主要讨论基于车辆动力学模型的控制理论和方法。
### 2.1 智能汽车整车动力学建模方法
* 20 世纪 30 年代初,Maurice Olley 最早提出操纵动力学理论,试图解决行驶平顺性和操纵稳定性之间的协调关系；
* Cough 等研究了轮胎特性并定义了侧偏角、不足转向和过度转向的概念
* Segel 提出了 3 自由度操纵动力学方程:在侧向、横摆基础上增加了侧倾运动,扩展了操纵动力学的分析内容,形成了一套较为完整的关于操纵和转向的基础理论体系。
* **根据自由度划分的整车模型如下**（只关注2自由度整车模型即可，其他更多自由度的模型都是针对特定问题的）
  1. 2 自由度整车模型：将整车看作是一个刚体，考虑了前后轴侧偏刚度,对左右两侧的车轮不进行区分,车轮转角直接作为模型的输入,定义了汽车的不足转向和过多转向特性。单轨 2自由度模型,模型忽略了车辆的垂向运动、俯仰运动、侧倾运动以及悬架运动,轴荷侧向转移、空气动力学载荷和转向几何,假设道路的超高和坡度,整车侧偏角和横摆角偏差都很小。**侧向加速度小于0.2g 的工况下,采用线性轮胎的传统2自由度“自行车”模型是完全够用的,使用这种低阶模型设计的控制器也表现良好**。参照文献[38]~[41]。（**即，当前Neolix中，将2自由度车辆模型研究清楚就够用了**）
  2. 3 自由度整车模型：包含横摆运动、侧向运动和侧倾运动的 3 自由度车辆模型来描述转向响应,研究表明该假设对于合理范围的侧向运动分析是可行的。 参照文献[42]~[44]。
  3. 7 自由度整车模型：采用魔术公式轮胎模型建立了非线性 7 自由度车辆模型,包括 4 个车轮的转动,车辆的纵向运动、侧向运动和横摆运动,研究了后轮转向系统对车辆操纵稳定性的影响。
  4. 8 自由度整车模型：包含4个车轮的转动,车辆的纵向运动、侧向运动、横摆运动和侧倾运动。 
  5. 12 自由度整车模型：簧载质量的6个自由度、两侧车轮绕主销转动自由度以及4个车轮的旋转自由度。
  6. 17 自由度整车模型：该模型对轮胎、悬架的非线性特性进行了充分描述,能够进行汽车侧翻、汽车稳定性、正弦扫频、极限操纵性和转弯制动等多种工况的仿真。
### 2.2 轮胎力学模型
**轮胎动力学研究的发展历程**
* ...
* Bakker和Pacejka等分别于1987年、1989年和1991年在试验研究的基础上总结出描述轮胎侧向力,制动力和回正力矩的解析表达式,建立了著名的“Magic Formula”模型。
* ...
**常用轮胎模型**
* 当仅研究低侧向加速度下的横向动力学时,线性侧向轮胎模型可以给出较好的结果。(**现阶段车辆动力学就只使用线性测量轮胎模型即可**)
* ...
### 2.3 智能汽车横向控制方法
* 现有的汽车横向控制方法有如下7种：经典控制、最优控制、自适应控制、鲁棒控制、滑模控制、模型预测控制、模糊控制。
**1、经典控制方法**
* 经典控制理论：线性定常系统、单输入、单输出
* 1991 年,文献[20] 研究了前馈鄄PID 反馈控制算法的横向控制。（此时没有高精地图，使用道路上的磁钉用作预瞄点，做为前馈的输入）
* 1998 年,文献[57] 指出在自动转向车辆中,通过横摆角速度反馈将横摆运动和横向运动解耦是经常用到的控制方法。（从此开始，将转向解耦为2个：横摆、横向。）
* 2011 年,文献[58] 基于单轨线性 2 自由度整车模型,提出了一种由期望航向偏差生成器和鲁棒PID反馈控制器组成的横向控制系统。该系统给出了不同车速范围的PID控制参数,具有较好的跟踪性能。（**引入航向偏差、根据不同车速范围设置不同Pid参数的思想，在Neolix中都有使用**）
* 2011 年,文献[59] 使用嵌套 PID 转向控制来进行自主车辆的路径保持。
* 总结：经典控制理论的控制框图见论文。虽然经典控制理论在工程上应用广泛,但具有明显的局限性,特别是难以有效地应用于多变量系统和时变系统,也难以揭示系统更深刻的特性。
**2、最优控制方法**
* 最优控制理论是在给定限制条件和性能指标下,寻找使系统性能在一定意义下为最优的控制规律。最优跟踪控制指的是基于最优化原理建立的反馈控制方法。（仍然是反馈控制方法）
* 文献[18] 根据最优横向控制律,选择反馈控制律的指标,并得出求解线性调节问题的 Riccati 代数方程,设计了速度适应的全状态反馈的横向控制器来满足横向位置跟踪精度、鲁棒性和乘坐舒适性的要求。
* 2006 年,马莹等提出了有限时间最优预瞄横向控制算法,使用了同时考虑车辆当前偏差、预瞄点偏差和控制变量的有限时间二次型性能指标函数,运用最优跟踪算法设计了最优预瞄控制器,仿真和试验结果表明该算法具有较好的跟踪效果。
* 总结：最优控制方法在一定条件下可取得不错的控制效果，但没考虑系统的一些不确定性因素，因此为了减小不确定性因素对系统控制性能的不利影响,又发展了两种控制方法:一种是自适应控
制,另一种是鲁棒控制。
**3、自适应控制方法**
* 自适应控制是指随时辨识系统的数学模型并按此模型去调整最优控制规律。即系统运行期间,系统自身能对有关干扰与不确定信息实现在线测量和处理,从而不断地修正系统结构的有关参数和控制作用,使之处于所要求的最优状态,得到期望的控制结果。（**目前实际使用中还从没接触过，先不细致研究此方法。**）
* 2004 年,Netto 建立了包含道路曲率和横向风阻变化引发振动的车辆动力学模型,提出了基于视觉的智能车辆横向自适应控制器,并通过仿真检验了该控制算法的有效性。（只是仿真阶段，没有工程实践）
* 文献[63]...
**4、鲁棒控制方法**
* 控制系统的鲁棒性一般是指系统在它的参数或结构发生摄动时保持某种原有品质的能力。鲁棒性包括鲁棒稳定性和鲁棒性能。
* ...
**5、滑模控制方法**
* 滑模控制(SMC)本质是一类特殊的非线性变结构控制,是由前苏联学者Utkin等于20世纪50年代提出的,其非线性表现为控制的不连续性。（**“滑模”是“滑动模态”的简称**） 
* ...
**6、模型预测控制方法（MPC）**
* 模型预测控制( MPC) 也叫做滚动时域最优控制,该控制器考虑控制系统的非线性动力学模型并预测未来一段时间内系统的输出行为,通过解决带约束的最优控制问题使得系统在未来一段时间内的
跟踪误差最小。
* 文献[71] 提出了对自主和半自主地面车辆的分层控制框架。上层路径规划基于由4轮非线性整车模型建立的运动基元,下层控制使用非线性模型预测控制器跟踪规划路径。
* 文献[72] 基于试验数据,比较了运动学和动力学2自由度模型预测车辆未来状态的误差。
* 文献[73] 采用 2 自由度自行车模型和魔术公式轮胎模型,对自主车辆的自动转向控制提出了一种非线性模型预测控制(NMPC)方法。
**7、模糊控制方法**（就是强化学习）
* 模糊控制是以模糊数学理论,即模糊集合论、模糊语言变量及模糊逻辑推理等作为理论基础,以传感器技术、计算机技术和自动控制理论作为技术基础的一种新型自动控制理论和方法。 
* ...
## 3 横向控制执行机构设计
* ...
## 4 总结和展望
* 智能汽车横向控制从 20 世纪 50 年代开始研究并持续到现在,控制方法先后经历了经典控制、现代控制和智能控制。 
* 智能汽车横向控制今后的研究重点将集中在如下几个方面：
  1. 整车动力学建模。
  2. 考虑车辆非线性、不确定性和时变特性的横向控制器设计。 
  3. 自动制动的同时紧急转向回避条件下,智能车辆纵向、横向耦合控制的研究。 
  4. 智能汽车一体化设计。


## 参考内容
* [魔术公式](https://www.cnblogs.com/xpvincent/archive/2013/02/03/2890802.html)
  注：“魔术公式”是用于轮胎模型的。是用三角函数的组合公式拟合轮胎试验数据，用一套形式相同的公式就可以完整地表达轮胎的纵向力Fx、侧向力Fy、回正力矩Mz、翻转力矩Mx、阻力矩My以及纵向力、侧向力的联合作用工况，故称为“魔术公式”。魔术公式的一般表达式为：y=f(x),具体见链接中。式中Y(x)可以是侧向力，也可以是回正力矩或者纵向力，自变量x可以在不同的情况下分别表示轮胎的侧偏角或纵向滑移率，式中的系数B、C、D依次由轮胎的垂直载荷和外倾角来确定。







































